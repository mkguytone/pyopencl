<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Chapter 21. Bitonic Sort（バイトニックソート）</title><link rel="stylesheet" type="text/css" href="index.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="home" href="index.html" title="Python OpenCL入門" /><link rel="up" href="pt05.html" title="Part V. PyOpenCL実装" /><link rel="prev" href="ch20s03.html" title="20.3. GPGPUへの修正点（メモリストライド・Bank Conflict対策）" /><link rel="next" href="ch21s01.html" title="21.1. バイトニック配列の構築" /><meta xmlns="" name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0" /><script xmlns="" type="text/javascript" src="prettify/prettify.js"></script><link xmlns="" rel="stylesheet" type="text/css" href="prettify/skins/sons-of-obsidian.css" /><script xmlns="">
    window.addEventListener("load", function() {
      PR.prettyPrint();
	  });	
	</script><script xmlns="" type="text/javascript" src="script/head.js"></script></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><td width="20%" align="left"><a accesskey="p" href="ch20s03.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="ch21s01.html">Next</a></td></tr></table><hr /></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="_bitonic_sort_バイトニックソート"></a>Chapter 21. Bitonic Sort（バイトニックソート）</h2></div></div></div><div class="toc"><p><strong>Table of Contents</strong></p><dl class="toc"><dt><span class="section"><a href="ch21s01.html">21.1. バイトニック配列の構築</a></span></dt><dt><span class="section"><a href="ch21s02.html">21.2. バイトニックマージ</a></span></dt><dt><span class="section"><a href="ch21s03.html">21.3. バイトニックソートのOpenCL実装例</a></span></dt><dt><span class="section"><a href="ch21s04.html">21.4. カーネルの実装（bitonic split）</a></span></dt><dt><span class="section"><a href="ch21s05.html">21.5. カーネルの実装（bitonic merge）</a></span></dt></dl></div><p>バイトニックソートは「Ken Batcher」が考案した並列ソートアルゴリズムです。完成度の高い並列化が可能なため、基数整列（radix sort）と同様にGPUでの整列アルゴリズムに適しています。</p><p>パフォーマンス上では、Radix Sortより劣りますが、一旦理解ができるようになると直感的に説明ができるようになることはアルゴリズムとしては大きな利点と言えるかと思います。</p><p>また並列コアを一定して使用させることができるため、最適化する余地が少ないことが、基数配列と比べて好まれる要因ともなっているようです。</p><p>バイトニック配列（またはシーケンス、シークエンス等）は以下の２つの式で表すことができます。</p><div class="informalfigure"><div class="mediaobject"><img src="images/bitonic_sequence_max.png" alt="images/bitonic_sequence_max.png" /></div></div><p>配列の要素はある一定の要素（配列の最大値）まで上昇し、そこから下降していきます。</p><div class="informalfigure"><div class="mediaobject"><img src="images/bitonic_sequence_min.png" alt="images/bitonic_sequence_min.png" /></div></div><p>もしくは配列の要素はある一定の要素（配列の最小値）まで下降し、そこから上昇していきます。</p><p>バイトニックソートは、このバイトニック配列を２つのバイトニック配列にする「バイトニック分割（Bitonic Split）」を行い、片方は少ない値、もう片方は大きい値をとる配列に分割し、それを繰り返します。</p><p>バイトニック分割を具体的に行なう場合は、バイトニック配列の添字（インデックス）を２つに分けます。そして２つに分けた配列の各要素を以下の式で比較します。</p><div class="informalfigure"><div class="mediaobject"><img src="images/bitonic_comparison.png" alt="images/bitonic_comparison.png" /></div></div><p>この式が成立するときは、値をスワップ（入れ替え）します。</p><p>ではバイトニック分割の一例を見てみましょう。以下の「Bitonic Split（１）」（<a class="xref" href="ch21.html#bitonic-split1" title="Table 21.1. Bitonic Split（１）">Table 21.1, “Bitonic Split（１）”</a>）では、8つの配列要素を、各４つのバイトニック配列に分割しています。</p><div class="table"><a id="bitonic-split1"></a><p class="title"><strong>Table 21.1. Bitonic Split（１）</strong></p><div class="table-contents"><table class="table" summary="Bitonic Split（１）" cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; border-left: 3px solid #527bbd; border-right: 3px solid #527bbd; "><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /><col class="col_4" /><col class="col_5" /><col class="col_6" /><col class="col_7" /><col class="col_8" /><col class="col_9" /></colgroup><tbody><tr><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">インデックス</pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">0</pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">1</pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">2</pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">3</pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">4</pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">5</pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">6</pre></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">7</pre></td></tr><tr><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">元シーケンス</pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">3</pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">7</pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">12</pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">98</pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">78</pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">66</pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">6</pre></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">5</pre></td></tr><tr><td style="border-right: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">スプリット後</pre></td><td style="border-right: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">3</pre></td><td style="border-right: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">7</pre></td><td style="border-right: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">6</pre></td><td style="border-right: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">5</pre></td><td style="border-right: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">78</pre></td><td style="border-right: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">66</pre></td><td style="border-right: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">12</pre></td><td style="" align="left" valign="top"><pre class="literallayout">98</pre></td></tr></tbody></table></div></div><br class="table-break" /><p>この例では以下の不等式によって、各要素のスワップ（入れ替え）を行います。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
3 &lt; 98（インデックス：0と4）
</li><li class="listitem">
7 &lt; 66（インデックス：1と5）
</li><li class="listitem">
12 &gt; 6（インデックス：2と6）、要素をスワップ
</li><li class="listitem">
98 &gt; 5（インデックス：3と7）、要素をスワップ
</li></ul></div><p>左半分【3,7,6,5】は上昇形態、【78,66,12,98】は下降形態となります。</p><p>「Bitonic Split（２）」（<a class="xref" href="ch21.html#bitonic-split2" title="Table 21.2. Bitonic Split（２）">Table 21.2, “Bitonic Split（２）”</a>）では、２つのバイトニック配列を４つに分割します。</p><div class="table"><a id="bitonic-split2"></a><p class="title"><strong>Table 21.2. Bitonic Split（２）</strong></p><div class="table-contents"><table class="table" summary="Bitonic Split（２）" cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; border-left: 3px solid #527bbd; border-right: 3px solid #527bbd; "><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /><col class="col_4" /><col class="col_5" /><col class="col_6" /><col class="col_7" /><col class="col_8" /><col class="col_9" /></colgroup><tbody><tr><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">インデックス</pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">0</pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">1</pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">2</pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">3</pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">4</pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">5</pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">6</pre></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">7</pre></td></tr><tr><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">元シーケンス</pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">3</pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">7</pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">6</pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">5</pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">78</pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">66</pre></td><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">12</pre></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">98</pre></td></tr><tr><td style="border-right: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">スプリット後</pre></td><td style="border-right: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">3</pre></td><td style="border-right: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">5</pre></td><td style="border-right: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">6</pre></td><td style="border-right: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">7</pre></td><td style="border-right: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">12</pre></td><td style="border-right: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">66</pre></td><td style="border-right: 1px solid #527bbd; " align="left" valign="top"><pre class="literallayout">78</pre></td><td style="" align="left" valign="top"><pre class="literallayout">98</pre></td></tr></tbody></table></div></div><br class="table-break" /><p>以下の不等式とスワップが行なわれます。</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
3 &lt; 6（インデックス：0と2）
</li><li class="listitem">
7 &gt; 5（インデックス：1と3）、要素をスワップ
</li><li class="listitem">
78 &gt; 12（インデックス：4と6）、要素をスワップ
</li><li class="listitem">
66 &lt; 98（インデックス：5と7）
</li></ul></div><p>このようにバイトニック分割を繰り返すことによって、整列化した配列に並び替えます。</p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch20s03.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="pt05.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="ch21s01.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top"> </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> </td></tr></table></div><wrapper xmlns=""><p>Copyright 2018-2019, by Masaki Komatsu</p>


</wrapper></body></html>